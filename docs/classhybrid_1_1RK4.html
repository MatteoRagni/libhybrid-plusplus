<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libhybrid++: hybrid::RK4&lt; REAL_T, dim_x, dim_u, dim_p, Args &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libhybrid++
   </div>
   <div id="projectbrief">A library for discretized Hybrid Dynamical Systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacehybrid.html">hybrid</a></li><li class="navelem"><a class="el" href="classhybrid_1_1RK4.html">RK4</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classhybrid_1_1RK4-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">hybrid::RK4&lt; REAL_T, dim_x, dim_u, dim_p, Args &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class for Explicit Euler integrator.  
 <a href="classhybrid_1_1RK4.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="rk4_8hpp_source.html">rk4.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for hybrid::RK4&lt; REAL_T, dim_x, dim_u, dim_p, Args &gt;:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classhybrid_1_1RK4.png" usemap="#hybrid::RK4_3C_20REAL_5FT_2C_20dim_5Fx_2C_20dim_5Fu_2C_20dim_5Fp_2C_20Args_20_3E_map" alt=""/>
  <map id="hybrid::RK4_3C_20REAL_5FT_2C_20dim_5Fx_2C_20dim_5Fu_2C_20dim_5Fp_2C_20Args_20_3E_map" name="hybrid::RK4_3C_20REAL_5FT_2C_20dim_5Fx_2C_20dim_5Fu_2C_20dim_5Fp_2C_20Args_20_3E_map">
<area href="classhybrid_1_1Integrator.html" alt="hybrid::Integrator&lt; REAL_T, dim_x, dim_u, dim_p, Args... &gt;" shape="rect" coords="0,0,351,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a34b9488ff0a9cdccccaab634a7ee4d43"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhybrid_1_1RK4.html#a34b9488ff0a9cdccccaab634a7ee4d43">RK4</a> (REAL_T _ts, <a class="el" href="namespacehybrid.html#af4efd4dea20d2a11c189e2a27d4aa110">OdeFunction</a>&lt; REAL_T, <a class="el" href="model__sliding__masses_8hpp.html#a540378639500cda3b6e97ae73d4bf10e">dim_x</a>, <a class="el" href="model__sliding__masses_8hpp.html#a7c891d8a2a603d025aec62d8e4e5673d">dim_u</a>, <a class="el" href="model__sliding__masses_8hpp.html#a15ad1c7b28eb81fd4634716b4012d821">dim_p</a>, Args... &gt; _f)</td></tr>
<tr class="memdesc:a34b9488ff0a9cdccccaab634a7ee4d43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contructor with function callback for ODE.  <a href="#a34b9488ff0a9cdccccaab634a7ee4d43">More...</a><br /></td></tr>
<tr class="separator:a34b9488ff0a9cdccccaab634a7ee4d43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c08037b7905298c47df00b9290a50fa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhybrid_1_1RK4.html#a2c08037b7905298c47df00b9290a50fa">RK4</a> (REAL_T _ts)</td></tr>
<tr class="memdesc:a2c08037b7905298c47df00b9290a50fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple constructor, only sampling time.  <a href="#a2c08037b7905298c47df00b9290a50fa">More...</a><br /></td></tr>
<tr class="separator:a2c08037b7905298c47df00b9290a50fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf8f9778808aea5d313ac1e5db2a374a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhybrid_1_1RK4.html#aaf8f9778808aea5d313ac1e5db2a374a">next</a> (std::array&lt; REAL_T, <a class="el" href="model__sliding__masses_8hpp.html#a540378639500cda3b6e97ae73d4bf10e">dim_x</a> &gt; &amp;xp, REAL_T &amp;t, const std::array&lt; REAL_T, <a class="el" href="model__sliding__masses_8hpp.html#a540378639500cda3b6e97ae73d4bf10e">dim_x</a> &gt; &amp;x, const std::array&lt; REAL_T, <a class="el" href="model__sliding__masses_8hpp.html#a7c891d8a2a603d025aec62d8e4e5673d">dim_u</a> &gt; &amp;u, const std::array&lt; REAL_T, <a class="el" href="model__sliding__masses_8hpp.html#a15ad1c7b28eb81fd4634716b4012d821">dim_p</a> &gt; &amp;p, Args... data)</td></tr>
<tr class="memdesc:aaf8f9778808aea5d313ac1e5db2a374a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The next step in the computation.  <a href="#aaf8f9778808aea5d313ac1e5db2a374a">More...</a><br /></td></tr>
<tr class="separator:aaf8f9778808aea5d313ac1e5db2a374a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ab71c7ba71afd4924dc3bb5835b179d43"><td class="memItemLeft" align="right" valign="top">REAL_T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhybrid_1_1Integrator.html#ab71c7ba71afd4924dc3bb5835b179d43">ts</a></td></tr>
<tr class="separator:ab71c7ba71afd4924dc3bb5835b179d43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b8324abcb8000fe6c9378bc34e04f57"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacehybrid.html#af4efd4dea20d2a11c189e2a27d4aa110">OdeFunction</a>&lt; REAL_T, <a class="el" href="model__sliding__masses_8hpp.html#a540378639500cda3b6e97ae73d4bf10e">dim_x</a>, <a class="el" href="model__sliding__masses_8hpp.html#a7c891d8a2a603d025aec62d8e4e5673d">dim_u</a>, <a class="el" href="model__sliding__masses_8hpp.html#a15ad1c7b28eb81fd4634716b4012d821">dim_p</a>, Args... &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhybrid_1_1Integrator.html#a3b8324abcb8000fe6c9378bc34e04f57">f</a></td></tr>
<tr class="separator:a3b8324abcb8000fe6c9378bc34e04f57"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename REAL_T, std::size_t dim_x, std::size_t dim_u, std::size_t dim_p, typename... Args&gt;<br />
class hybrid::RK4&lt; REAL_T, dim_x, dim_u, dim_p, Args &gt;</h3>

<p>Class for Explicit Euler integrator. </p>
<p>This is the implementation of a Runge Kutta 4th order integration scheme that does not use dynamical memory allocation. All dimensions are defined in a static way, through templating. The ode is required to be defined as: </p><p class="formulaDsp">
\[ \dot{x}(t) = f(t, x(t), u(t), p), \qquad x(t) \in \mathbb{R}^{\dim(x)}, \, u(t) \in \mathbb{R}^{\dim(u)} \, p \in \mathbb{R}^{\dim(p)} \]
</p>
<p> The ODE styles is in same way compatible with the MATLAB System identification toolbox idnlgrey function call. The only difference is in the parameter vector that in this case is in a single array (instead of a <code>REAL_T**</code> vector). The integration scheme follows:</p>
<p class="formulaDsp">
\[ x^+ = x + t_s f(t, x(t), u(t), p) \]
</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">REAL_T</td><td>floating point precision </td></tr>
    <tr><td class="paramname">dim_x</td><td>dimension of the state array </td></tr>
    <tr><td class="paramname">dim_u</td><td>dimension of the external forces array </td></tr>
    <tr><td class="paramname">dim_p</td><td>dimension of the parameters array </td></tr>
    <tr><td class="paramname">Args</td><td>variadic template for user arguments </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rk4_8hpp_source.html#l00090">90</a> of file <a class="el" href="rk4_8hpp_source.html">rk4.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a34b9488ff0a9cdccccaab634a7ee4d43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34b9488ff0a9cdccccaab634a7ee4d43">&#9670;&nbsp;</a></span>RK4() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename REAL_T , std::size_t dim_x, std::size_t dim_u, std::size_t dim_p, typename... Args&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classhybrid_1_1RK4.html">hybrid::RK4</a>&lt; REAL_T, <a class="el" href="model__sliding__masses_8hpp.html#a540378639500cda3b6e97ae73d4bf10e">dim_x</a>, <a class="el" href="model__sliding__masses_8hpp.html#a7c891d8a2a603d025aec62d8e4e5673d">dim_u</a>, <a class="el" href="model__sliding__masses_8hpp.html#a15ad1c7b28eb81fd4634716b4012d821">dim_p</a>, Args &gt;::<a class="el" href="classhybrid_1_1RK4.html">RK4</a> </td>
          <td>(</td>
          <td class="paramtype">REAL_T&#160;</td>
          <td class="paramname"><em>_ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacehybrid.html#af4efd4dea20d2a11c189e2a27d4aa110">OdeFunction</a>&lt; REAL_T, <a class="el" href="model__sliding__masses_8hpp.html#a540378639500cda3b6e97ae73d4bf10e">dim_x</a>, <a class="el" href="model__sliding__masses_8hpp.html#a7c891d8a2a603d025aec62d8e4e5673d">dim_u</a>, <a class="el" href="model__sliding__masses_8hpp.html#a15ad1c7b28eb81fd4634716b4012d821">dim_p</a>, Args... &gt;&#160;</td>
          <td class="paramname"><em>_f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Contructor with function callback for ODE. </p>
<p>Constructor with function callback for ODE</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_ts</td><td>sampling time </td></tr>
    <tr><td class="paramname">_f</td><td>callback for the ODE </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rk4_8hpp_source.html#l00099">99</a> of file <a class="el" href="rk4_8hpp_source.html">rk4.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        : <a class="code" href="classhybrid_1_1Integrator.html#a5fd17505975058e5d57ae22e93cb282a">Integrator</a>&lt; REAL_T, <a class="code" href="model__bouncing__ball_8hpp.html#a540378639500cda3b6e97ae73d4bf10e">dim_x</a>, <a class="code" href="model__bouncing__ball_8hpp.html#a7c891d8a2a603d025aec62d8e4e5673d">dim_u</a>, <a class="code" href="model__bouncing__ball_8hpp.html#a15ad1c7b28eb81fd4634716b4012d821">dim_p</a>, Args... &gt;(_ts, _f){};</div><div class="ttc" id="classhybrid_1_1Integrator_html_a5fd17505975058e5d57ae22e93cb282a"><div class="ttname"><a href="classhybrid_1_1Integrator.html#a5fd17505975058e5d57ae22e93cb282a">hybrid::Integrator&lt; REAL_T, dim_x, dim_u, dim_p, Args... &gt;::Integrator</a></div><div class="ttdeci">Integrator(REAL_T _ts, OdeFunction&lt; REAL_T, dim_x, dim_u, dim_p, Args... &gt; _f)</div><div class="ttdoc">a generic constructor for integrators </div><div class="ttdef"><b>Definition:</b> <a href="integrator_8hpp_source.html#l00086">integrator.hpp:86</a></div></div>
<div class="ttc" id="model__bouncing__ball_8hpp_html_a540378639500cda3b6e97ae73d4bf10e"><div class="ttname"><a href="model__bouncing__ball_8hpp.html#a540378639500cda3b6e97ae73d4bf10e">dim_x</a></div><div class="ttdeci">const std::size_t dim_x</div><div class="ttdef"><b>Definition:</b> <a href="model__bouncing__ball_8hpp_source.html#l00060">model_bouncing_ball.hpp:60</a></div></div>
<div class="ttc" id="model__bouncing__ball_8hpp_html_a15ad1c7b28eb81fd4634716b4012d821"><div class="ttname"><a href="model__bouncing__ball_8hpp.html#a15ad1c7b28eb81fd4634716b4012d821">dim_p</a></div><div class="ttdeci">const std::size_t dim_p</div><div class="ttdef"><b>Definition:</b> <a href="model__bouncing__ball_8hpp_source.html#l00062">model_bouncing_ball.hpp:62</a></div></div>
<div class="ttc" id="model__bouncing__ball_8hpp_html_a7c891d8a2a603d025aec62d8e4e5673d"><div class="ttname"><a href="model__bouncing__ball_8hpp.html#a7c891d8a2a603d025aec62d8e4e5673d">dim_u</a></div><div class="ttdeci">const std::size_t dim_u</div><div class="ttdef"><b>Definition:</b> <a href="model__bouncing__ball_8hpp_source.html#l00061">model_bouncing_ball.hpp:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c08037b7905298c47df00b9290a50fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c08037b7905298c47df00b9290a50fa">&#9670;&nbsp;</a></span>RK4() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename REAL_T , std::size_t dim_x, std::size_t dim_u, std::size_t dim_p, typename... Args&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classhybrid_1_1RK4.html">hybrid::RK4</a>&lt; REAL_T, <a class="el" href="model__sliding__masses_8hpp.html#a540378639500cda3b6e97ae73d4bf10e">dim_x</a>, <a class="el" href="model__sliding__masses_8hpp.html#a7c891d8a2a603d025aec62d8e4e5673d">dim_u</a>, <a class="el" href="model__sliding__masses_8hpp.html#a15ad1c7b28eb81fd4634716b4012d821">dim_p</a>, Args &gt;::<a class="el" href="classhybrid_1_1RK4.html">RK4</a> </td>
          <td>(</td>
          <td class="paramtype">REAL_T&#160;</td>
          <td class="paramname"><em>_ts</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Simple constructor, only sampling time. </p>
<p>Simple constructor with only sampling time</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_ts</td><td>sampling time </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rk4_8hpp_source.html#l00108">108</a> of file <a class="el" href="rk4_8hpp_source.html">rk4.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;: <a class="code" href="classhybrid_1_1Integrator.html#a5fd17505975058e5d57ae22e93cb282a">Integrator</a>&lt; REAL_T, <a class="code" href="model__bouncing__ball_8hpp.html#a540378639500cda3b6e97ae73d4bf10e">dim_x</a>, <a class="code" href="model__bouncing__ball_8hpp.html#a7c891d8a2a603d025aec62d8e4e5673d">dim_u</a>, <a class="code" href="model__bouncing__ball_8hpp.html#a15ad1c7b28eb81fd4634716b4012d821">dim_p</a>, Args... &gt;(_ts){};</div><div class="ttc" id="classhybrid_1_1Integrator_html_a5fd17505975058e5d57ae22e93cb282a"><div class="ttname"><a href="classhybrid_1_1Integrator.html#a5fd17505975058e5d57ae22e93cb282a">hybrid::Integrator&lt; REAL_T, dim_x, dim_u, dim_p, Args... &gt;::Integrator</a></div><div class="ttdeci">Integrator(REAL_T _ts, OdeFunction&lt; REAL_T, dim_x, dim_u, dim_p, Args... &gt; _f)</div><div class="ttdoc">a generic constructor for integrators </div><div class="ttdef"><b>Definition:</b> <a href="integrator_8hpp_source.html#l00086">integrator.hpp:86</a></div></div>
<div class="ttc" id="model__bouncing__ball_8hpp_html_a540378639500cda3b6e97ae73d4bf10e"><div class="ttname"><a href="model__bouncing__ball_8hpp.html#a540378639500cda3b6e97ae73d4bf10e">dim_x</a></div><div class="ttdeci">const std::size_t dim_x</div><div class="ttdef"><b>Definition:</b> <a href="model__bouncing__ball_8hpp_source.html#l00060">model_bouncing_ball.hpp:60</a></div></div>
<div class="ttc" id="model__bouncing__ball_8hpp_html_a15ad1c7b28eb81fd4634716b4012d821"><div class="ttname"><a href="model__bouncing__ball_8hpp.html#a15ad1c7b28eb81fd4634716b4012d821">dim_p</a></div><div class="ttdeci">const std::size_t dim_p</div><div class="ttdef"><b>Definition:</b> <a href="model__bouncing__ball_8hpp_source.html#l00062">model_bouncing_ball.hpp:62</a></div></div>
<div class="ttc" id="model__bouncing__ball_8hpp_html_a7c891d8a2a603d025aec62d8e4e5673d"><div class="ttname"><a href="model__bouncing__ball_8hpp.html#a7c891d8a2a603d025aec62d8e4e5673d">dim_u</a></div><div class="ttdeci">const std::size_t dim_u</div><div class="ttdef"><b>Definition:</b> <a href="model__bouncing__ball_8hpp_source.html#l00061">model_bouncing_ball.hpp:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aaf8f9778808aea5d313ac1e5db2a374a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf8f9778808aea5d313ac1e5db2a374a">&#9670;&nbsp;</a></span>next()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename REAL_T , std::size_t dim_x, std::size_t dim_u, std::size_t dim_p, typename... Args&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classhybrid_1_1RK4.html">hybrid::RK4</a>&lt; REAL_T, <a class="el" href="model__sliding__masses_8hpp.html#a540378639500cda3b6e97ae73d4bf10e">dim_x</a>, <a class="el" href="model__sliding__masses_8hpp.html#a7c891d8a2a603d025aec62d8e4e5673d">dim_u</a>, <a class="el" href="model__sliding__masses_8hpp.html#a15ad1c7b28eb81fd4634716b4012d821">dim_p</a>, Args &gt;::next </td>
          <td>(</td>
          <td class="paramtype">std::array&lt; REAL_T, <a class="el" href="model__sliding__masses_8hpp.html#a540378639500cda3b6e97ae73d4bf10e">dim_x</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>xp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL_T &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::array&lt; REAL_T, <a class="el" href="model__sliding__masses_8hpp.html#a540378639500cda3b6e97ae73d4bf10e">dim_x</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::array&lt; REAL_T, <a class="el" href="model__sliding__masses_8hpp.html#a7c891d8a2a603d025aec62d8e4e5673d">dim_u</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::array&lt; REAL_T, <a class="el" href="model__sliding__masses_8hpp.html#a15ad1c7b28eb81fd4634716b4012d821">dim_p</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Args...&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The next step in the computation. </p>
<p>The function evaluates the next step for te integration, evaluating as follows using the ODE callback:</p>
<p>The step implements a Runge-Kutta 4 scheme with the following tableau: </p><div class="fragment"><div class="line"> 0  |  0   0   0   0</div><div class="line">1/2 | 1/2  0   0   0</div><div class="line">1/2 |  0  1/2  0   0</div><div class="line"> 1  |  0   0   1   0</div><div class="line">----+----------------</div><div class="line">    | 1/6 1/3 1/3 1/6</div></div><!-- fragment --><p> For the ode in the form: </p><p class="formulaDsp">
\[ \dot{x}(t) = f(t, x(t), u(t), p), \quad x(t_0) = x_0 \]
</p>
<p> The integration scheme evaluates: </p><p class="formulaDsp">
\[ x(t_k + h) = x(t_k) + t_s \sum_{i = 1}^{4} b_i k_i \]
</p>
<p> where: </p><p class="formulaDsp">
\[ k_i = f(t + c_i t_s, x(t_k) + t_s \sum_{j=1}^{i-1} a_{i,j} k_j, u(t_k), p) \]
</p>
<p>The input \( u(t_k) \) is assumed constant between integration ministeps.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xp</td><td>result from the next step in the integration </td></tr>
    <tr><td class="paramname">t</td><td>flow time </td></tr>
    <tr><td class="paramname">x</td><td>current state </td></tr>
    <tr><td class="paramname">u</td><td>current input </td></tr>
    <tr><td class="paramname">p</td><td>parameters vector </td></tr>
    <tr><td class="paramname">data</td><td>user data </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classhybrid_1_1Integrator.html#aabd7582f7c242e92b2e0ca10b96ea49d">hybrid::Integrator&lt; REAL_T, dim_x, dim_u, dim_p, Args... &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="rk4_8hpp_source.html#l00147">147</a> of file <a class="el" href="rk4_8hpp_source.html">rk4.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                                                                                    {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keyword">const</span> std::array&lt; REAL_T, 4 &gt; a = {0, 0.5, 0.5, 1};</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keyword">const</span> std::array&lt; REAL_T, 4 &gt; b = {1.0 / 6.0, 1.0 / 3.0, 1.0 / 3.0, 1.0 / 6.0};</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keyword">const</span> std::array&lt; REAL_T, 4 &gt; c = {0.0, 0.5, 0.5, 1.0};</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      std::array&lt; std::array&lt; REAL_T, dim_x &gt;, 4 &gt; k = {0.0};</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      std::array&lt; REAL_T, dim_x &gt; z;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      REAL_T tau = t;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <a class="code" href="namespacehybrid_1_1math.html#a8761540f78d5c31e2450532d36c04a49">hybrid::math::copy</a>(xp, x);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      this-&gt;<a class="code" href="classhybrid_1_1Integrator.html#a3b8324abcb8000fe6c9378bc34e04f57">f</a>(k[0], tau, x, u, p, data...);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <a class="code" href="namespacehybrid_1_1math.html#abe0261c588eae54d2b55f56ac26cb3ed">hybrid::math::sum</a>(xp, k[0], this-&gt;<a class="code" href="classhybrid_1_1Integrator.html#ab71c7ba71afd4924dc3bb5835b179d43">ts</a> * b[0]);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">for</span> (std::size_t i = 1; i &lt; 4; i++) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        tau = t + c[i] * this-&gt;<a class="code" href="classhybrid_1_1Integrator.html#ab71c7ba71afd4924dc3bb5835b179d43">ts</a>;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <a class="code" href="namespacehybrid_1_1math.html#a8761540f78d5c31e2450532d36c04a49">hybrid::math::copy</a>(z, x);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <a class="code" href="namespacehybrid_1_1math.html#abe0261c588eae54d2b55f56ac26cb3ed">hybrid::math::sum</a>(z, k[i - 1], a[i] * this-&gt;ts);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        this-&gt;<a class="code" href="classhybrid_1_1Integrator.html#a3b8324abcb8000fe6c9378bc34e04f57">f</a>(k[i], tau, z, u, p, data...);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <a class="code" href="namespacehybrid_1_1math.html#abe0261c588eae54d2b55f56ac26cb3ed">hybrid::math::sum</a>(xp, k[i], this-&gt;ts * b[i]);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      </div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      t += this-&gt;<a class="code" href="classhybrid_1_1Integrator.html#ab71c7ba71afd4924dc3bb5835b179d43">ts</a>;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    };</div><div class="ttc" id="namespacehybrid_1_1math_html_abe0261c588eae54d2b55f56ac26cb3ed"><div class="ttname"><a href="namespacehybrid_1_1math.html#abe0261c588eae54d2b55f56ac26cb3ed">hybrid::math::sum</a></div><div class="ttdeci">void sum(std::array&lt; REAL_T, dim &gt; &amp;out, const std::array&lt; REAL_T, dim &gt; &amp;in, const REAL_T scale)</div><div class="ttdoc">Scale and sum two arrays. </div><div class="ttdef"><b>Definition:</b> <a href="math_8hpp_source.html#l00337">math.hpp:337</a></div></div>
<div class="ttc" id="classhybrid_1_1Integrator_html_ab71c7ba71afd4924dc3bb5835b179d43"><div class="ttname"><a href="classhybrid_1_1Integrator.html#ab71c7ba71afd4924dc3bb5835b179d43">hybrid::Integrator&lt; REAL_T, dim_x, dim_u, dim_p, Args... &gt;::ts</a></div><div class="ttdeci">REAL_T ts</div><div class="ttdef"><b>Definition:</b> <a href="integrator_8hpp_source.html#l00075">integrator.hpp:75</a></div></div>
<div class="ttc" id="classhybrid_1_1Integrator_html_a3b8324abcb8000fe6c9378bc34e04f57"><div class="ttname"><a href="classhybrid_1_1Integrator.html#a3b8324abcb8000fe6c9378bc34e04f57">hybrid::Integrator&lt; REAL_T, dim_x, dim_u, dim_p, Args... &gt;::f</a></div><div class="ttdeci">OdeFunction&lt; REAL_T, dim_x, dim_u, dim_p, Args... &gt; f</div><div class="ttdef"><b>Definition:</b> <a href="integrator_8hpp_source.html#l00076">integrator.hpp:76</a></div></div>
<div class="ttc" id="namespacehybrid_1_1math_html_a8761540f78d5c31e2450532d36c04a49"><div class="ttname"><a href="namespacehybrid_1_1math.html#a8761540f78d5c31e2450532d36c04a49">hybrid::math::copy</a></div><div class="ttdeci">void copy(std::array&lt; REAL_T, n &gt; &amp;dest, const std::array&lt; REAL_T, n &gt; &amp;src)</div><div class="ttdoc">Copy a source array in a destination. </div><div class="ttdef"><b>Definition:</b> <a href="math_8hpp_source.html#l00464">math.hpp:464</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a3b8324abcb8000fe6c9378bc34e04f57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b8324abcb8000fe6c9378bc34e04f57">&#9670;&nbsp;</a></span>f</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacehybrid.html#af4efd4dea20d2a11c189e2a27d4aa110">OdeFunction</a>&lt; REAL_T, <a class="el" href="model__sliding__masses_8hpp.html#a540378639500cda3b6e97ae73d4bf10e">dim_x</a>, <a class="el" href="model__sliding__masses_8hpp.html#a7c891d8a2a603d025aec62d8e4e5673d">dim_u</a>, <a class="el" href="model__sliding__masses_8hpp.html#a15ad1c7b28eb81fd4634716b4012d821">dim_p</a>, Args... &gt; <a class="el" href="classhybrid_1_1Integrator.html">hybrid::Integrator</a>&lt; REAL_T, <a class="el" href="model__sliding__masses_8hpp.html#a540378639500cda3b6e97ae73d4bf10e">dim_x</a>, <a class="el" href="model__sliding__masses_8hpp.html#a7c891d8a2a603d025aec62d8e4e5673d">dim_u</a>, <a class="el" href="model__sliding__masses_8hpp.html#a15ad1c7b28eb81fd4634716b4012d821">dim_p</a>, Args &gt;::f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Ode function pointer </p>

<p class="definition">Definition at line <a class="el" href="integrator_8hpp_source.html#l00076">76</a> of file <a class="el" href="integrator_8hpp_source.html">integrator.hpp</a>.</p>

</div>
</div>
<a id="ab71c7ba71afd4924dc3bb5835b179d43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab71c7ba71afd4924dc3bb5835b179d43">&#9670;&nbsp;</a></span>ts</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">REAL_T <a class="el" href="classhybrid_1_1Integrator.html">hybrid::Integrator</a>&lt; REAL_T, <a class="el" href="model__sliding__masses_8hpp.html#a540378639500cda3b6e97ae73d4bf10e">dim_x</a>, <a class="el" href="model__sliding__masses_8hpp.html#a7c891d8a2a603d025aec62d8e4e5673d">dim_u</a>, <a class="el" href="model__sliding__masses_8hpp.html#a15ad1c7b28eb81fd4634716b4012d821">dim_p</a>, Args &gt;::ts</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Integration step </p>

<p class="definition">Definition at line <a class="el" href="integrator_8hpp_source.html#l00075">75</a> of file <a class="el" href="integrator_8hpp_source.html">integrator.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/<a class="el" href="rk4_8hpp_source.html">rk4.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
